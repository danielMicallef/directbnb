{% extends "base.html" %}
{% load static %}

{% block title %}Create Your Website - {{ site_name }}{% endblock %}
{% block navbar%} {% endblock %}
{% block content %}
<div class="conatiner mt-6">
    <div class="max-w-4xl mx-auto" x-data="wizardData()">
        <div class="card bg-base-200 shadow-xl">
            <div class="card-body">


                <!-- Wizard Content -->
                <div
                    id="wizard-content"
                    hx-target="this"
                    hx-swap="innerHTML"
                >
                    {% include 'builder/wizard_step_partial.html' %}
                </div>
            </div>
        </div>
    </div>
</div>

<script>
function wizardData() {
    return {
        step: {{ step }},
        totalSteps: {{ total_steps }},
    }
}

// Auto-dismiss messages
document.addEventListener('DOMContentLoaded', () => {
    const alerts = document.querySelectorAll('.alert');
    alerts.forEach(alert => {
        setTimeout(() => {
            alert.style.opacity = '0';
            setTimeout(() => alert.remove(), 500);
        }, 5000);
    });
});

// Handle HX-Redirect header for Stripe checkout
document.body.addEventListener('htmx:beforeSwap', function(evt) {
    if (evt.detail.xhr.getResponseHeader('HX-Redirect')) {
        const redirectUrl = evt.detail.xhr.getResponseHeader('HX-Redirect');
        window.location.href = redirectUrl;
        evt.detail.shouldSwap = false; // Prevent HTMX from swapping content
    }
});
</script>

{% endblock %}

